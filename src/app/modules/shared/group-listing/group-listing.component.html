
<app-navbar></app-navbar>
<div class="flex flex-col h-screen max-w-full md:max-w-2xl lg:max-w-4xl mx-auto mt-4 bg-gray-900 border border-gray-300 rounded-lg shadow-lg">
    <!-- Users List -->
    <div class="flex flex-col w-full bg-gray-900 overflow-y-auto">
        <div class="flex justify-between items-center p-4 bg-[#008069] border-b border-gray-400">


            <!-- <button class="text-white hover:text-white mr-2" (click)="navigateToUserChatListing()">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7 7-7"></path>
                </svg>
            </button> -->
            
            <button (click)="navigateToUserChatListing()"> <h2 class="text-md font-bold text-[#edede9] " >Chats</h2></button>

            
            <!-- Group Chat Icon -->
            <!--  -->
            <button   class="text-white hover:text-white mr-2"  [ngStyle]="{
                'margin-bottom': groupChatSection ? '20px' : '0',
                'border-bottom': groupChatSection ? '3px solid black' : 'none'
            }">
                <svg
                    version="1.1"
                    id="Layer_1"
                    xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink"
                    x="0px"
                    y="0px"
                    viewBox="0 0 100.353 100.353"
                    style="enable-background:new 0 0 100.353 100.353;"
                    xml:space="preserve"
                    class="w-8 h-8"
                >
                    <g>
                        <path d="M49.106,50.437c-12.167,0-22.066,9.898-22.066,22.065c0,0.828,0.671,1.5,1.5,1.5h41.131c0.828,0,1.5-0.672,1.5-1.5C71.171,60.335,61.272,50.437,49.106,50.437z M30.099,71.002c0.768-9.814,9-17.565,19.007-17.565c10.007,0,18.239,7.751,19.006,17.565H30.099z" fill="#ffffff"></path>
                        <path d="M48.746,48.456c7.143,0,12.954-5.811,12.954-12.954c0-7.143-5.812-12.954-12.954-12.954c-7.143,0-12.954,5.811-12.954,12.954C35.792,42.645,41.603,48.456,48.746,48.456z M48.746,25.548c5.488,0,9.954,4.465,9.954,9.954c0,5.488-4.466,9.954-9.954,9.954c-5.489,0-9.954-4.465-9.954-9.954C38.792,30.013,43.257,25.548,48.746,25.548z" fill="#ffffff"></path>
                        <path d="M19.78,58.714c2.461,0,4.878,0.656,6.99,1.898c0.714,0.422,1.634,0.181,2.053-0.532c0.42-0.714,0.182-1.634-0.533-2.054c-2.572-1.513-5.515-2.312-8.51-2.312c-9.257,0-16.788,7.531-16.788,16.788c0,0.828,0.671,1.5,1.5,1.5h19.012c0.829,0,1.5-0.672,1.5-1.5s-0.671-1.5-1.5-1.5H6.073C6.823,64.102,12.684,58.714,19.78,58.714z" fill="#ffffff"></path>
                        <path d="M19.514,53.319c5.521,0,10.014-4.492,10.014-10.014c0-5.522-4.492-10.014-10.014-10.014c-5.522,0-10.014,4.492-10.014,10.014C9.5,48.826,13.992,53.319,19.514,53.319z M19.514,36.291c3.867,0,7.014,3.146,7.014,7.014c0,3.867-3.146,7.014-7.014,7.014c-3.868,0-7.014-3.146-7.014-7.014C12.5,39.437,15.646,36.291,19.514,36.291z" fill="#ffffff"></path>
                        <path d="M78.553,55.714c-2.994,0-5.937,0.8-8.51,2.312c-0.715,0.42-0.953,1.339-0.533,2.053c0.42,0.716,1.342,0.953,2.053,0.533c2.113-1.242,4.53-1.898,6.99-1.898c7.096,0,12.957,5.388,13.707,12.288H74.832c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h19.009c0.828,0,1.5-0.672,1.5-1.5C95.341,63.245,87.81,55.714,78.553,55.714z" fill="#ffffff"></path>
                        <path d="M78.82,53.319c5.521,0,10.014-4.492,10.014-10.014c0-5.522-4.492-10.014-10.014-10.014c-5.522,0-10.015,4.492-10.015,10.014C68.806,48.826,73.298,53.319,78.82,53.319z M78.82,36.291c3.867,0,7.014,3.146,7.014,7.014c0,3.867-3.146,7.014-7.014,7.014c-3.868,0-7.015-3.146-7.015-7.014C71.806,39.437,74.952,36.291,78.82,36.291z" fill="#ffffff"></path>
                    </g>
                </svg>
            </button>
            
            
              
            <!-- New Group Icon -->
            <button (click)="showModal()" class="text-[#edede9] hover:text-white" >
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.5v15m7.5-7.5h-15"></path>
                </svg>
            </button>
        </div>
        <div class="flex flex-col space-y-2 p-2">
            <!-- User Item -->
            <div *ngFor="let item of groups"  class="flex items-center p-2 bg-white hover:bg-gray-100 cursor-pointer rounded-lg"(click)="navigateToChatView(item._id,item.groupName)">
                <img src="https://via.placeholder.com/40" class="w-10 h-10 rounded-full" alt="User Avatar">
                <div class="ml-3" >
                    <p class="text-sm font-semibold text-gray-700">{{item.groupName}}</p>
                    <p class="text-xs text-gray-500">Last message...</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal -->
<div *ngIf="isModalVisible" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
    <div class="bg-white p-6 rounded-lg shadow-lg w-full max-w-md">
        <h2 class="text-lg font-semibold mb-4">Create New Group</h2>
        <form (ngSubmit)="createGroup(form)" #form="ngForm">
            <div class="mb-4">
                <label for="groupName" class="block text-gray-700">Group Name</label>
                <input type="text" id="groupName" name="groupName" [(ngModel)]="groupName" class="mt-1 p-2 w-full border rounded" required #groupNameRef="ngModel">
                <div *ngIf="groupNameRef.invalid && groupNameRef.touched" class="text-red-500 text-sm">
                    Group Name is required.
                </div>
            </div>
            <div class="mb-4">
                <label class="block text-gray-700">Select Users</label>
                <div *ngFor="let user of users" class="flex items-center mt-2">
                    <input type="checkbox" [value]="user._id" (change)="toggleUserSelection(user._id, $event)" name="selectedUserIds" [checked]="selectedUserIds.includes(user._id)">
                    <span class="ml-2">{{ user.firstName }}</span>
                </div>
                <div *ngIf="!isUserSelected() && form.submitted" class="text-red-500 text-sm">
                    At least one user must be selected.
                </div>
            </div>
            <div class="flex justify-end">
                <button type="button" (click)="hideModal()" class="mr-2 px-4 py-2 bg-gray-300 rounded">Cancel</button>
                <button type="submit" class="px-4 py-2 bg-blue-500 text-white rounded">Create</button>
            </div>
        </form>
    </div>
</div>

